<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>webpack</title>
    <url>/webpack/</url>
    <content><![CDATA[<h2 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h2><p><code>package.json</code><br><figure class="highlight"><table><tr><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "dev": "webpack-dev-server --inline --progress --config build/webpack.dev.conf.js",</span><br><span class="line">  "test": "node build/build.js", // 测试</span><br><span class="line">  "build": "node build/build.js", // 线上</span><br><span class="line">  "upload": "ossUpload yfrelease dist ucm -c"</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p><code>config/dev.env.js</code><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> testEnv = <span class="built_in">require</span>(<span class="string">'./test.env'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(testEnv, &#123;</span><br><span class="line">  NODE_ENV: <span class="string">'"development"'</span>,</span><br><span class="line">  API_SANBOX: <span class="string">'"http://sandbox.gw.fdc.com.cn/router/rest"'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><code>config/test.env.js</code><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> prodEnv = <span class="built_in">require</span>(<span class="string">'./prod.env'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(prodEnv, &#123;</span><br><span class="line">  NODE_ENV: <span class="string">'"production"'</span>,</span><br><span class="line">  API_SANBOX: <span class="string">'"http://sandbox.gw.fdc.com.cn/router/rest"'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><code>config/pre.env.js</code><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> prodEnv = <span class="built_in">require</span>(<span class="string">'./prod.env'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(prodEnv, &#123;</span><br><span class="line">  NODE_ENV: <span class="string">'"production"'</span>,</span><br><span class="line">  API_SANBOX: <span class="string">'"http://pregw.fdc.com.cn/router/rest"'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><code>config/prod.env.js</code><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  NODE_ENV: <span class="string">'"production"'</span>,</span><br><span class="line">  API_SANBOX:<span class="string">'"http://gw.fdc.com.cn/router/rest"'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>config/index.js</code><br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> environment = &#123;</span><br><span class="line">  test: &#123;</span><br><span class="line">    env: <span class="built_in">require</span>(<span class="string">'./test.env'</span>),</span><br><span class="line">    assetsPublicPath: <span class="string">'http://test.uc.m.fdc.com.cn/'</span>,</span><br><span class="line">    productionSourceMap: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  build: &#123;</span><br><span class="line">    env: <span class="built_in">require</span>(<span class="string">'./prod.env'</span>),</span><br><span class="line">    assetsPublicPath: <span class="string">'http://static.fdc.com.cn/ucm/'</span>,</span><br><span class="line">    productionSourceMap: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  build: merge(&#123;</span><br><span class="line">    <span class="comment">// Template for index.html</span></span><br><span class="line">    index: path.resolve(__dirname, <span class="string">'../dist/index.html'</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Paths</span></span><br><span class="line">    assetsRoot: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    assetsSubDirectory: <span class="string">'static'</span>,</span><br><span class="line">    assetsPublicPath: <span class="string">'https://static.fdc.com.cn/ucm/'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Source Maps</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    productionSourceMap: <span class="literal">true</span>,</span><br><span class="line">    devtool: <span class="string">'#source-map'</span>,</span><br><span class="line">    productionGzip: <span class="literal">false</span>,</span><br><span class="line">    productionGzipExtensions: [<span class="string">'js'</span>, <span class="string">'css'</span>],</span><br><span class="line">    bundleAnalyzerReport: process.env.npm_config_report</span><br><span class="line">  &#125;,environment[process.env.npm_lifecycle_event])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ yarn build //  process.env.npm_lifecycle_event == &apos;build&apos;</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
</search>
